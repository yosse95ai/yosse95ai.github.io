---
import { getCollection } from 'astro:content';

const images = await getCollection('gallery');
---

<section class="p-4 sm:p-6">
  <div class="columns-2 sm:columns-3 lg:columns-4 gap-3 space-y-3">
    {images.map((img, i) => (
      <div
        class="break-inside-avoid overflow-hidden rounded-2xl photo-item"
        style={`box-shadow: 0 1px 4px oklch(0.70 0.010 150 / 0.12); animation-delay: ${i * 60}ms;`}
      >
        <img
          src={img.data.src}
          alt={img.data.alt}
          class="w-full h-auto block select-none pointer-events-none"
          loading="lazy"
          decoding="async"
          draggable="false"
        />
      </div>
    ))}
  </div>
</section>

<style>
  .photo-item {
    opacity: 0;
    transform: translateY(16px);
    animation: photo-fadein 0.45s ease forwards;
  }

  @keyframes photo-fadein {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  // 右クリック・長押し防止
  document.addEventListener('contextmenu', (e) => {
    if ((e.target as HTMLElement).tagName === 'IMG') e.preventDefault();
  });
  document.addEventListener('touchstart', (e) => {
    if ((e.target as HTMLElement).tagName === 'IMG') e.preventDefault();
  }, { passive: false });
</script>
