---
/**
 * „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Ç´„Çø„É≠„Ç∞ÔºàÈñãÁô∫„Éª„Éá„Éê„ÉÉ„Ç∞Áî®Ôºâ
 * Êú¨Áï™Áí∞Â¢É„Åß„ÅØ„Éà„ÉÉ„Éó„Éö„Éº„Ç∏„Å∏„É™„ÉÄ„Ç§„É¨„ÇØ„Éà
 */
import Badge from '../components/atoms/Badge.astro';
import Tag from '../components/atoms/Tag.astro';
import Icon from '../components/atoms/Icon.astro';
import KiroIcon from '../components/atoms/KiroIcon.astro';
import DifyIcon from '../components/atoms/DifyIcon.astro';
import OgpCard from '../components/molecules/OgpCard.astro';
import SkillItem from '../components/molecules/SkillItem.astro';
import SocialLink from '../components/molecules/SocialLink.astro';
import TimelineItem from '../components/molecules/TimelineItem.astro';
import { fetchOgp } from '../lib/fetchOgp';
import { getCollection } from 'astro:content';
import Header from '../components/organisms/Header.astro';
import HeroSection from '../components/organisms/HeroSection.astro';
import CareerTimeline from '../components/organisms/CareerTimeline.astro';
import SkillsGrid from '../components/organisms/SkillsGrid.astro';
import BlogList from '../components/organisms/BlogList.astro';
import PhotoGrid from '../components/organisms/PhotoGrid.astro';

if (import.meta.env.PROD) {
  return Astro.redirect('/');
}

const sampleUrls = [
  'https://aws.amazon.com/jp/blogs/news/introducing-powers/',
  'https://findy-tools.io/articles/aws-amplify-gen-2/40',
];

const sampleOgp = await Promise.all(
  sampleUrls.map(async (url) => ({ ...(await fetchOgp(url)), url }))
);

// skills.json „Åã„Çâ„Éá„Éº„ÇøÂèñÂæó„Åó„Å¶„Ç´„ÉÜ„Ç¥„É™Âà•„Å´ÂàÜÈ°û
const allSkills = await getCollection('skills');
const categories = ['cloud', 'language', 'framework', 'tool', 'other'] as const;
const skillsByCategory = Object.fromEntries(
  categories.map(cat => [cat, allSkills.filter(s => s.data.category === cat)])
);
---

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Ç´„Çø„É≠„Ç∞</title>
    <style>@import '../styles/global.css';</style>
  </head>
  <body class="p-8 space-y-12" style="background: oklch(0.98 0.005 120); color: oklch(0.20 0.010 250);">

    <h1 class="text-3xl font-bold border-b pb-4" style="border-color: oklch(0.88 0.008 150);">
      üß© „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Ç´„Çø„É≠„Ç∞
    </h1>

    <!-- ===== Badge ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">Badge</h2>
      <div class="flex flex-wrap gap-3 items-center">
        <Badge variant="primary">primary</Badge>
        <Badge variant="secondary">secondary</Badge>
        <Badge variant="ghost">ghost</Badge>
        <Badge variant="primary" size="md">primary md</Badge>
        <Badge variant="secondary" size="md">secondary md</Badge>
      </div>
    </section>

    <!-- ===== Tag ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">Tag</h2>
      <div class="flex flex-wrap gap-3 items-center">
        <Tag type="aws" />
        <Tag type="other" />
      </div>
    </section>

    <!-- ===== Icon ===== -->
    <section class="space-y-6">
      <h2 class="text-xl font-semibold">Icon</h2>
      {categories.map(cat => (
        <div>
          <p class="text-xs font-mono mb-3" style="color: oklch(0.55 0.010 250);">{cat}</p>
          <div class="flex flex-wrap gap-6 items-end">
            {skillsByCategory[cat].map(skill => (
              <div class="flex flex-col items-center gap-1">
                {skill.data.icon === 'local:kiro' ? (
                  <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background: oklch(0.52 0.24 295);">
                    <KiroIcon size={20} />
                  </div>
                ) : skill.data.icon === 'local:dify' ? (
                  <div class="h-8 flex items-center justify-center">
                    <DifyIcon size={20} />
                  </div>
                ) : skill.data.icon ? (
                  <Icon name={skill.data.icon} size={32} />
                ) : (
                  <span class="w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold" style="background: oklch(0.55 0.12 60);">
                    {skill.data.name.charAt(0)}
                  </span>
                )}
                <span class="text-xs">{skill.data.name}</span>
              </div>
            ))}
          </div>
        </div>
      ))}

      <!-- SNS -->
      <div>
        <p class="text-xs font-mono mb-3" style="color: oklch(0.55 0.010 250);">SNS</p>
        <div class="flex flex-wrap gap-6 items-end">
          <div class="flex flex-col items-center gap-1">
            <Icon name="simple-icons:github" size={32} label="GitHub" />
            <span class="text-xs">GitHub</span>
          </div>
          <div class="flex flex-col items-center gap-1">
            <Icon name="simple-icons:linkedin" size={32} style="color: oklch(0.45 0.17 250);" label="LinkedIn" />
            <span class="text-xs">LinkedIn</span>
          </div>
          <div class="flex flex-col items-center gap-1">
            <Icon name="simple-icons:qiita" size={32} style="color: oklch(0.60 0.17 155);" label="Qiita" />
            <span class="text-xs">Qiita</span>
          </div>
          <div class="flex flex-col items-center gap-1">
            <Icon name="simple-icons:zenn" size={32} style="color: oklch(0.68 0.17 240);" label="Zenn" />
            <span class="text-xs">Zenn</span>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== „Ç´„É©„Éº„Éë„É¨„ÉÉ„Éà ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">„Ç´„É©„Éº„Éë„É¨„ÉÉ„Éà</h2>
      <div class="flex flex-wrap gap-3">
        {[
          { name: 'bg', value: 'oklch(0.98 0.005 120)' },
          { name: 'surface', value: 'oklch(0.96 0.006 120)' },
          { name: 'primary', value: 'oklch(0.55 0.15 145)' },
          { name: 'secondary', value: 'oklch(0.60 0.08 150)' },
          { name: 'border', value: 'oklch(0.88 0.008 150)' },
          { name: 'text', value: 'oklch(0.20 0.010 250)' },
          { name: 'text-muted', value: 'oklch(0.45 0.010 250)' },
        ].map(({ name, value }) => (
          <div class="flex flex-col items-center gap-1">
            <div
              class="w-16 h-16 rounded-lg border"
              style={`background: ${value}; border-color: oklch(0.88 0.008 150);`}
            />
            <span class="text-xs font-mono">{name}</span>
          </div>
        ))}
      </div>
    </section>

    <!-- ===== Molecules: OgpCard ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">OgpCard</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl">
        {sampleOgp.map(({ url, title, description, ogpImage }) => (
          <OgpCard
            externalUrl={url}
            title={title}
            description={description}
            ogpImage={ogpImage}
          />
        ))}
      </div>
    </section>

    <!-- ===== Molecules: SkillItem ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">SkillItem</h2>
      <div class="flex flex-wrap gap-1 max-w-2xl">
        {allSkills.map(skill => (
          <SkillItem
            name={skill.data.name}
            icon={skill.data.icon}
            url={skill.data.url}
            category={skill.data.category}
          />
        ))}
      </div>
    </section>

    <!-- ===== Molecules: SocialLink ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">SocialLink</h2>
      <div class="flex flex-col gap-2 max-w-xs">
        <SocialLink platform="github" url="https://github.com/yosse95ai" />
        <SocialLink platform="linkedin" url="https://www.linkedin.com/in/hiroaki-yoshimura/" />
        <SocialLink platform="qiita" url="https://qiita.com/yosse95ai" />
        <SocialLink platform="zenn" url="https://zenn.dev/yosse95ai" />
      </div>
    </section>

    <!-- ===== Molecules: TimelineItem ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">TimelineItem</h2>
      <div class="max-w-sm">
        <TimelineItem
          organization="Amazon Web ServicesÔºàAWSÔºâ"
          role="Solutions Architect"
          startDate="2023-04"
          endDate={null}
        />
        <TimelineItem
          organization="‰πùÂ∑ûÂ∑•Ê•≠Â§ßÂ≠¶ Â§ßÂ≠¶Èô¢"
          role="ÂÖàÁ´ØÊÉÖÂ†±Â∑•Â≠¶Â∞ÇÊîªÔºàÊÉÖÂ†±Â∑•Â≠¶Ôºâ"
          startDate="2021-04"
          endDate="2023-03"
        />
        <TimelineItem
          organization="‰πùÂ∑ûÂ∑•Ê•≠Â§ßÂ≠¶"
          role="ÊÉÖÂ†±Â∑•Â≠¶ÈÉ® Áü•ËÉΩÊÉÖÂ†±Â∑•Â≠¶Áßë"
          startDate="2017-04"
          endDate="2021-03"
          isLast={true}
        />
      </div>
    </section>

    <!-- ===== „Çø„Ç§„Éù„Ç∞„É©„Éï„Ç£ ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">„Çø„Ç§„Éù„Ç∞„É©„Éï„Ç£</h2>
      <div class="space-y-2">
        <p class="text-4xl font-bold">Ë¶ãÂá∫„Åó H1 / Heading</p>
        <p class="text-2xl font-semibold">Ë¶ãÂá∫„Åó H2 / Subheading</p>
        <p class="text-lg font-medium">Ë¶ãÂá∫„Åó H3 / Section</p>
        <p class="text-base">Êú¨Êñá„ÉÜ„Ç≠„Çπ„Éà / Body text ‚Äî AWS„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„Ç®„É≥„Ç∏„Éã„Ç¢</p>
        <p class="text-sm" style="color: oklch(0.45 0.010 250);">Ë£úË∂≥„ÉÜ„Ç≠„Çπ„Éà / Muted text</p>
        <p class="font-mono text-sm">Á≠âÂπÖ„Éï„Ç©„É≥„Éà / Monospace: const hello = "world"</p>
      </div>
    </section>

    <!-- ===== Organisms: Header ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">Header</h2>
      <p class="text-xs" style="color: oklch(0.55 0.010 250);">‚Äª „Éö„Éº„Ç∏‰∏äÈÉ®„Å´ sticky Ë°®Á§∫„Åï„Çå„Å¶„ÅÑ„Çã„ÇÇ„ÅÆ„ÅåÂÆüÁâ©„Åß„Åô</p>
      <div class="border rounded-2xl overflow-hidden" style="border-color: oklch(0.88 0.008 150);">
        <Header />
      </div>
    </section>

    <!-- ===== Organisms: HeroSection ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">HeroSection</h2>
      <div class="max-w-2xl">
        <HeroSection />
      </div>
    </section>

    <!-- ===== Organisms: CareerTimeline ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">CareerTimeline</h2>
      <div class="max-w-sm">
        <CareerTimeline />
      </div>
    </section>

    <!-- ===== Organisms: SkillsGrid ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">SkillsGrid</h2>
      <div class="max-w-3xl">
        <SkillsGrid />
      </div>
    </section>

    <!-- ===== Organisms: BlogList ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">BlogList</h2>
      <BlogList />
    </section>

    <!-- ===== Organisms: PhotoGrid ===== -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">PhotoGrid</h2>
      <PhotoGrid />
    </section>

  </body>
</html>
