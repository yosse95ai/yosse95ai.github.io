---
import BaseLayout from '../components/templates/BaseLayout.astro';
import HeroSection from '../components/organisms/HeroSection.astro';
import CareerTimeline from '../components/organisms/CareerTimeline.astro';
import SkillsGrid from '../components/organisms/SkillsGrid.astro';
import BlogList from '../components/organisms/BlogList.astro';
import SocialLink from '../components/molecules/SocialLink.astro';

const socialLinks = [
  { platform: 'github'   as const, url: 'https://github.com/yosse95ai' },
  { platform: 'linkedin' as const, url: 'https://www.linkedin.com/in/hiroaki-yoshimura/' },
  { platform: 'qiita'    as const, url: 'https://qiita.com/yosse95ai' },
  { platform: 'zenn'     as const, url: 'https://zenn.dev/yosse95ai' },
];
---

<BaseLayout>
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex flex-col gap-4 md:gap-5">

    <!-- 行1: Hero × SNS -->
    <div class="grid grid-cols-1 md:grid-cols-12 gap-4 md:gap-5 items-stretch">
      <div class="md:col-span-8 flex" data-animate>
        <HeroSection />
      </div>
      <div
        class="md:col-span-4 rounded-3xl p-6 flex flex-col justify-center gap-3"
        data-animate style="background: var(--color-surface); box-shadow: 0 1px 4px var(--color-shadow-sm);"
      >
        <h2 class="text-sm font-semibold uppercase tracking-wider mb-1" style="color: var(--color-primary);">
          Links
        </h2>
        {socialLinks.map(({ platform, url }) => (
          <SocialLink platform={platform} url={url} />
        ))}
      </div>
    </div>

    <!-- 行2: Career × Skills -->
    <div class="grid grid-cols-1 md:grid-cols-12 gap-4 md:gap-5 items-stretch">
      <div class="md:col-span-4 flex" data-animate>
        <CareerTimeline showAll={false} />
      </div>
      <div class="md:col-span-8 flex" data-animate>
        <SkillsGrid />
      </div>
    </div>

    <!-- 行3: Blog -->
    <div data-animate>
      <BlogList />
    </div>

  </div>
</BaseLayout>

<script>
  // View Transitions 後に is-visible を付与し直す
  function initAnimations() {
    document.querySelectorAll('[data-animate]').forEach((el) => {
      el.classList.remove('is-visible');
      // 少し遅らせて reflow を確保してから付与
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          el.classList.add('is-visible');
        });
      });
    });
  }

  initAnimations();
  document.addEventListener('astro:page-load', initAnimations);
</script>

<style>
  [data-animate] {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  [data-animate].is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>
